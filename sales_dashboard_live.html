<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë´„ë‚ ì—” íŒë§¤ ëŒ€ì‹œë³´ë“œ (ì‹¤ì‹œê°„ ì—°ë™)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(102, 126, 234, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-content {
            text-align: center;
            color: white;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            display: none;
        }

        .dashboard.loaded {
            display: block;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .header-title {
            flex: 1;
        }

        .header h1 {
            color: #667eea;
            font-size: 36px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            color: #666;
            font-size: 16px;
        }

        .sync-info {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #10b981;
            font-size: 14px;
        }

        .sync-dot {
            width: 10px;
            height: 10px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .period-filter {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .period-btn {
            padding: 12px 24px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .period-btn:hover {
            background: #f0f3ff;
        }

        .period-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
        }

        .custom-period {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 15px;
        }

        .date-input {
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
        }

        .date-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .apply-btn {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s ease;
        }

        .apply-btn:hover {
            background: #5568d3;
        }

        .refresh-btn {
            padding: 10px 20px;
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .refresh-btn:hover {
            background: #f0f3ff;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-label {
            color: #999;
            font-size: 14px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-value {
            color: #333;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-change {
            font-size: 14px;
            color: #10b981;
        }

        .stat-change.negative {
            color: #ef4444;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .chart-card h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        .table-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .table-card h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #f8f9fa;
        }

        th {
            padding: 12px;
            text-align: left;
            font-size: 14px;
            font-weight: 600;
            color: #666;
            border-bottom: 2px solid #e9ecef;
        }

        td {
            padding: 12px;
            font-size: 14px;
            border-bottom: 1px solid #e9ecef;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .product-name {
            font-weight: 500;
            color: #333;
        }

        .rank {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: 700;
            font-size: 14px;
        }

        .error-message {
            background: #fee;
            color: #c33;
            padding: 20px;
            border-radius: 10px;
            margin: 20px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 28px;
            }

            .header-top {
                flex-direction: column;
                align-items: flex-start;
            }

            .period-filter {
                width: 100%;
            }

            .period-btn {
                flex: 1;
                min-width: 80px;
            }
        }
    </style>
</head>
<body>
    <div class="loading" id="loadingScreen">
        <div class="loading-content">
            <div class="spinner"></div>
            <h2>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</h2>
            <p>êµ¬ê¸€ ì‹œíŠ¸ì—ì„œ ìµœì‹  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆìŠµë‹ˆë‹¤</p>
        </div>
    </div>

    <div class="dashboard" id="dashboard">
        <div class="header">
            <div class="header-top">
                <div class="header-title">
                    <h1>ğŸŒ¸ ë´„ë‚ ì—” íŒë§¤ ëŒ€ì‹œë³´ë“œ</h1>
                    <p id="periodDisplay">ì „ì²´ ê¸°ê°„</p>
                    <div class="sync-info">
                        <div class="sync-dot"></div>
                        <span>êµ¬ê¸€ ì‹œíŠ¸ì™€ ì‹¤ì‹œê°„ ì—°ë™</span>
                    </div>
                </div>
                <button class="refresh-btn" onclick="loadData()">
                    <span>ğŸ”„</span>
                    <span>ìƒˆë¡œê³ ì¹¨</span>
                </button>
            </div>
            <div class="period-filter">
                <button class="period-btn active" data-period="all">ì „ì²´</button>
                <button class="period-btn" data-period="7">ìµœê·¼ 7ì¼</button>
                <button class="period-btn" data-period="30">ìµœê·¼ 30ì¼</button>
                <button class="period-btn" data-period="custom">ì‚¬ìš©ì ì§€ì •</button>
            </div>
            <div class="custom-period" id="customPeriod" style="display: none;">
                <input type="date" id="startDate" class="date-input">
                <span>~</span>
                <input type="date" id="endDate" class="date-input">
                <button class="apply-btn" onclick="applyCustomPeriod()">ì ìš©</button>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">ì´ ë§¤ì¶œ</div>
                <div class="stat-value" id="totalRevenue">-</div>
                <div class="stat-change" id="revenueChange"></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ì´ ì£¼ë¬¸ ìˆ˜</div>
                <div class="stat-value" id="totalOrders">-</div>
                <div class="stat-change" id="ordersChange"></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ì´ íŒë§¤ ìˆ˜ëŸ‰</div>
                <div class="stat-value" id="totalItems">-</div>
                <div class="stat-change" id="itemsChange"></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">í‰ê·  ì£¼ë¬¸ ê¸ˆì•¡</div>
                <div class="stat-value" id="avgOrderValue">-</div>
                <div class="stat-change" id="avgChange"></div>
            </div>
        </div>

        <div class="chart-grid">
            <div class="chart-card">
                <h3>ğŸ“ˆ ì¼ë³„ ë§¤ì¶œ ì¶”ì´</h3>
                <div class="chart-container">
                    <canvas id="dailySalesChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <h3>ğŸ† ì¸ê¸° ìƒí’ˆ TOP 10</h3>
                <div class="chart-container">
                    <canvas id="topProductsChart"></canvas>
                </div>
            </div>
        </div>

        <div class="table-card">
            <h3>ğŸ¯ ë² ìŠ¤íŠ¸ ì…€ëŸ¬ ìƒí’ˆ</h3>
            <table id="bestSellersTable">
                <thead>
                    <tr>
                        <th>ìˆœìœ„</th>
                        <th>ìƒí’ˆëª…</th>
                        <th>íŒë§¤ìˆ˜ëŸ‰</th>
                        <th>ë§¤ì¶œ</th>
                        <th>ì£¼ë¬¸ìˆ˜</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <script>
        // âš™ï¸ ì—¬ê¸°ì— êµ¬ê¸€ ì‹œíŠ¸ URLì„ ì…ë ¥í•˜ì„¸ìš”
        const SHEET_URL = 'YOUR_GOOGLE_SHEET_URL_HERE';
        
        let allData = {
            daily_sales: [],
            products: []
        };
        let dailyChart, topProductsChart;
        let currentPeriod = 'all';

        // ìˆ«ì í¬ë§·íŒ… í•¨ìˆ˜
        function formatNumber(num) {
            return new Intl.NumberFormat('ko-KR').format(Math.round(num));
        }

        function formatCurrency(num) {
            return new Intl.NumberFormat('ko-KR').format(Math.round(num)) + 'ì›';
        }

        // êµ¬ê¸€ ì‹œíŠ¸ì—ì„œ ë°ì´í„° ë¡œë“œ
        async function loadData() {
            try {
                const loadingScreen = document.getElementById('loadingScreen');
                loadingScreen.style.display = 'flex';

                // ì£¼ë¬¸ë‚´ì—­ ì‹œíŠ¸ ë¡œë“œ
                const response = await fetch(SHEET_URL);
                const csvText = await response.text();
                
                Papa.parse(csvText, {
                    header: true,
                    complete: function(results) {
                        processData(results.data);
                        loadingScreen.style.display = 'none';
                        document.getElementById('dashboard').classList.add('loaded');
                    },
                    error: function(error) {
                        console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
                        showError('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. êµ¬ê¸€ ì‹œíŠ¸ URLì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                    }
                });
            } catch (error) {
                console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
                showError('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. êµ¬ê¸€ ì‹œíŠ¸ê°€ ì›¹ì— ê²Œì‹œë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.');
            }
        }

        // ë°ì´í„° ì²˜ë¦¬
        function processData(rawData) {
            // ì¼ë³„ ë§¤ì¶œ ì§‘ê³„
            const dailySalesMap = {};
            const productSalesMap = {};
            
            rawData.forEach(row => {
                if (!row['ê²°ì œì¼ì'] || !row['ì œí’ˆë§¤ì¶œ']) return;
                
                const date = row['ê²°ì œì¼ì'].split(' ')[0]; // ë‚ ì§œë§Œ ì¶”ì¶œ
                const revenue = parseFloat(row['ì œí’ˆë§¤ì¶œ']) || 0;
                const quantity = parseFloat(row['íŒë§¤ìˆ˜ëŸ‰']) || 0;
                const orderNum = row['ì£¼ë¬¸ë²ˆí˜¸'];
                const productName = row['ìƒí’ˆëª…'];
                
                // ì¼ë³„ ì§‘ê³„
                if (!dailySalesMap[date]) {
                    dailySalesMap[date] = {
                        ë‚ ì§œ: date,
                        ë§¤ì¶œ: 0,
                        ì£¼ë¬¸ìˆ˜: new Set(),
                        íŒë§¤ìˆ˜ëŸ‰: 0
                    };
                }
                dailySalesMap[date].ë§¤ì¶œ += revenue;
                dailySalesMap[date].ì£¼ë¬¸ìˆ˜.add(orderNum);
                dailySalesMap[date].íŒë§¤ìˆ˜ëŸ‰ += quantity;
                
                // ìƒí’ˆë³„ ì§‘ê³„
                if (productName) {
                    if (!productSalesMap[productName]) {
                        productSalesMap[productName] = {
                            ìƒí’ˆëª…: productName,
                            íŒë§¤ìˆ˜ëŸ‰: 0,
                            ë§¤ì¶œ: 0,
                            ì£¼ë¬¸ìˆ˜: new Set()
                        };
                    }
                    productSalesMap[productName].íŒë§¤ìˆ˜ëŸ‰ += quantity;
                    productSalesMap[productName].ë§¤ì¶œ += revenue;
                    productSalesMap[productName].ì£¼ë¬¸ìˆ˜.add(orderNum);
                }
            });
            
            // ì¼ë³„ ë°ì´í„° ë³€í™˜
            allData.daily_sales = Object.values(dailySalesMap)
                .map(d => ({
                    ë‚ ì§œ: d.ë‚ ì§œ,
                    ë§¤ì¶œ: d.ë§¤ì¶œ,
                    ì£¼ë¬¸ìˆ˜: d.ì£¼ë¬¸ìˆ˜.size,
                    íŒë§¤ìˆ˜ëŸ‰: d.íŒë§¤ìˆ˜ëŸ‰
                }))
                .sort((a, b) => a.ë‚ ì§œ.localeCompare(b.ë‚ ì§œ));
            
            // ìƒí’ˆë³„ ë°ì´í„° ë³€í™˜ ë° ì •ë ¬
            allData.products = Object.values(productSalesMap)
                .map(p => ({
                    ìƒí’ˆëª…: p.ìƒí’ˆëª…,
                    íŒë§¤ìˆ˜ëŸ‰: p.íŒë§¤ìˆ˜ëŸ‰,
                    ë§¤ì¶œ: p.ë§¤ì¶œ,
                    ì£¼ë¬¸ìˆ˜: p.ì£¼ë¬¸ìˆ˜.size
                }))
                .sort((a, b) => b.íŒë§¤ìˆ˜ëŸ‰ - a.íŒë§¤ìˆ˜ëŸ‰)
                .slice(0, 20); // ìƒìœ„ 20ê°œë§Œ
            
            // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
            updateDashboard(currentPeriod);
        }

        // ì—ëŸ¬ í‘œì‹œ
        function showError(message) {
            document.getElementById('loadingScreen').style.display = 'none';
            document.body.innerHTML += `<div class="error-message"><h2>âš ï¸ ì˜¤ë¥˜</h2><p>${message}</p></div>`;
        }

        // ë‚ ì§œ í•„í„°ë§ í•¨ìˆ˜
        function filterDataByPeriod(period, startDate = null, endDate = null) {
            let filteredData = [...allData.daily_sales];
            
            if (period === 'all') {
                // ì „ì²´ ë°ì´í„°
            } else if (period === '7') {
                filteredData = filteredData.slice(-7);
            } else if (period === '30') {
                filteredData = filteredData.slice(-30);
            } else if (period === 'custom' && startDate && endDate) {
                filteredData = filteredData.filter(d => {
                    return d.ë‚ ì§œ >= startDate && d.ë‚ ì§œ <= endDate;
                });
            }
            
            return filteredData;
        }

        // í†µê³„ ê³„ì‚° í•¨ìˆ˜
        function calculateStats(data) {
            const totalRevenue = data.reduce((sum, d) => sum + d.ë§¤ì¶œ, 0);
            const totalOrders = data.reduce((sum, d) => sum + d.ì£¼ë¬¸ìˆ˜, 0);
            const totalItems = data.reduce((sum, d) => sum + d.íŒë§¤ìˆ˜ëŸ‰, 0);
            const avgOrderValue = totalOrders > 0 ? totalRevenue / totalOrders : 0;
            
            return {
                totalRevenue,
                totalOrders,
                totalItems,
                avgOrderValue
            };
        }

        // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateDashboard(period, startDate = null, endDate = null) {
            const filteredData = filterDataByPeriod(period, startDate, endDate);
            
            if (filteredData.length === 0) {
                console.warn('í•„í„°ë§ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            const stats = calculateStats(filteredData);
            
            // ê¸°ê°„ í‘œì‹œ ì—…ë°ì´íŠ¸
            let periodText = '';
            if (period === 'all') {
                const firstDate = filteredData[0].ë‚ ì§œ;
                const lastDate = filteredData[filteredData.length - 1].ë‚ ì§œ;
                periodText = `ì „ì²´ ê¸°ê°„ (${firstDate} ~ ${lastDate})`;
            } else if (period === '7') {
                periodText = 'ìµœê·¼ 7ì¼';
            } else if (period === '30') {
                periodText = 'ìµœê·¼ 30ì¼';
            } else if (period === 'custom') {
                periodText = `${startDate} ~ ${endDate}`;
            }
            document.getElementById('periodDisplay').textContent = periodText;
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            document.getElementById('totalRevenue').textContent = formatCurrency(stats.totalRevenue);
            document.getElementById('totalOrders').textContent = formatNumber(stats.totalOrders) + 'ê±´';
            document.getElementById('totalItems').textContent = formatNumber(stats.totalItems) + 'ê°œ';
            document.getElementById('avgOrderValue').textContent = formatCurrency(stats.avgOrderValue);
            
            // ë³€í™”ìœ¨ ê³„ì‚°
            const prevData = period === '7' ? filterDataByPeriod('all').slice(-14, -7) :
                            period === '30' ? filterDataByPeriod('all').slice(-60, -30) :
                            [];
            
            if (prevData.length > 0) {
                const prevStats = calculateStats(prevData);
                const revenueChange = ((stats.totalRevenue - prevStats.totalRevenue) / prevStats.totalRevenue * 100).toFixed(1);
                const ordersChange = ((stats.totalOrders - prevStats.totalOrders) / prevStats.totalOrders * 100).toFixed(1);
                const itemsChange = ((stats.totalItems - prevStats.totalItems) / prevStats.totalItems * 100).toFixed(1);
                const avgChange = ((stats.avgOrderValue - prevStats.avgOrderValue) / prevStats.avgOrderValue * 100).toFixed(1);
                
                updateChangeDisplay('revenueChange', revenueChange);
                updateChangeDisplay('ordersChange', ordersChange);
                updateChangeDisplay('itemsChange', itemsChange);
                updateChangeDisplay('avgChange', avgChange);
            } else {
                document.getElementById('revenueChange').textContent = '';
                document.getElementById('ordersChange').textContent = '';
                document.getElementById('itemsChange').textContent = '';
                document.getElementById('avgChange').textContent = '';
            }
            
            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            updateCharts(filteredData);
            
            // í…Œì´ë¸” ì—…ë°ì´íŠ¸
            updateTable();
        }

        function updateChangeDisplay(id, change) {
            const element = document.getElementById(id);
            const isPositive = parseFloat(change) >= 0;
            element.textContent = `ì „ ê¸°ê°„ ëŒ€ë¹„ ${isPositive ? '+' : ''}${change}%`;
            element.className = isPositive ? 'stat-change' : 'stat-change negative';
        }

        // ì°¨íŠ¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateCharts(data) {
            // ì¼ë³„ ë§¤ì¶œ ì°¨íŠ¸
            if (dailyChart) {
                dailyChart.destroy();
            }
            
            const dailyCtx = document.getElementById('dailySalesChart').getContext('2d');
            dailyChart = new Chart(dailyCtx, {
                type: 'line',
                data: {
                    labels: data.map(d => d.ë‚ ì§œ.substring(5)),
                    datasets: [{
                        label: 'ì¼ë³„ ë§¤ì¶œ',
                        data: data.map(d => d.ë§¤ì¶œ),
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true,
                        pointRadius: 3,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return formatCurrency(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return (value / 1000000).toFixed(0) + 'M';
                                }
                            }
                        }
                    }
                }
            });

            // ì¸ê¸° ìƒí’ˆ ì°¨íŠ¸
            if (topProductsChart) {
                topProductsChart.destroy();
            }
            
            const topProducts = allData.products.slice(0, 10);
            const topProductsCtx = document.getElementById('topProductsChart').getContext('2d');
            topProductsChart = new Chart(topProductsCtx, {
                type: 'bar',
                data: {
                    labels: topProducts.map(p => {
                        const words = p.ìƒí’ˆëª….split(' ');
                        return words.length > 2 ? words[1] + ' ' + words[2] : p.ìƒí’ˆëª…;
                    }),
                    datasets: [{
                        label: 'íŒë§¤ ìˆ˜ëŸ‰',
                        data: topProducts.map(p => p.íŒë§¤ìˆ˜ëŸ‰),
                        backgroundColor: [
                            '#667eea', '#764ba2', '#f093fb', '#4facfe',
                            '#43e97b', '#fa709a', '#fee140', '#30cfd0',
                            '#a8edea', '#fbc2eb'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // í…Œì´ë¸” ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateTable() {
            const tbody = document.querySelector('#bestSellersTable tbody');
            tbody.innerHTML = '';
            
            allData.products.forEach((product, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td><span class="rank">${index + 1}</span></td>
                    <td class="product-name">${product.ìƒí’ˆëª…}</td>
                    <td>${formatNumber(product.íŒë§¤ìˆ˜ëŸ‰)}ê°œ</td>
                    <td>${formatCurrency(product.ë§¤ì¶œ)}</td>
                    <td>${formatNumber(product.ì£¼ë¬¸ìˆ˜)}ê±´</td>
                `;
            });
        }

        // ê¸°ê°„ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.querySelectorAll('.period-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const period = this.dataset.period;
                currentPeriod = period;
                
                const customPeriod = document.getElementById('customPeriod');
                if (period === 'custom') {
                    customPeriod.style.display = 'flex';
                    const today = new Date();
                    const thirtyDaysAgo = new Date(today);
                    thirtyDaysAgo.setDate(today.getDate() - 30);
                    
                    document.getElementById('startDate').value = thirtyDaysAgo.toISOString().split('T')[0];
                    document.getElementById('endDate').value = today.toISOString().split('T')[0];
                } else {
                    customPeriod.style.display = 'none';
                    updateDashboard(period);
                }
            });
        });

        // ì‚¬ìš©ì ì§€ì • ê¸°ê°„ ì ìš©
        function applyCustomPeriod() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            if (startDate && endDate) {
                updateDashboard('custom', startDate, endDate);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ
        window.addEventListener('load', loadData);
    </script>
</body>
</html>